# Spectra Phase1-M Experiment Configuration
# ==========================================
# This is the SINGLE source of truth for all experiments.
# run_pipeline.py reads this file - no hardcoded values in code.

experiment:
  name: "Spectra-Phase1-M"
  description: "Multi-model generalization of query norm â†’ attention control"
  phase: "Phase1-M"
  preregistered: true
  seed: 42

# Model configurations
# LOCKED: Single model for this run
models:
  - name: "meta-llama/Meta-Llama-3-8B"
    family: "llama"
    enabled: true

  # Future models (disabled for Phase1-M initial run):
  # - name: "meta-llama/Meta-Llama-3-70B"
  #   family: "llama"
  #   enabled: false
  # - name: "mistralai/Mistral-7B-v0.1"
  #   family: "mistral"
  #   enabled: false

# Context lengths - CORE VARIABLE FOR THIS RUN
context_lengths:
  planned: [128, 512, 1024]
  enabled: [128, 512, 1024]

# Scaling factors for intervention experiments
alphas:
  default: [0.5, 0.75, 1.0, 1.25, 1.5]
  description: "Symmetric scaling around identity to test monotonicity"

# Which experiments to run
experiments:
  exp0:
    enabled: true
    description: "Observational correlation analysis"

  exp1:
    enabled: true
    description: "Causal Q-scaling intervention"
    target_layer: 12
    target_head: 0
    selection: "fixed_control_head"

  exp2b:
    enabled: true
    description: "Global gain analysis (all heads)"

  exp3a:
    enabled: false # Disabled: exp3b is a superset (tests 3 heads including median)
    description: "Q vs K scaling control"
    depends_on: "exp2b"
    head_selection: "median_gain_head"

  exp3b:
    enabled: true
    description: "Gain-conditioned Q vs K comparison"
    depends_on: "exp2b"
    high_gain_percentile: 95
    medium_gain_percentile: 50
    low_gain_percentile: 5

# Data configuration
data:
  source: "preprocessed"
  directory: "data/processed"
  sample_idx: 0
  note: "Same sample reused across all context lengths for controlled comparison"

# Output configuration
output:
  base_dir: "results"
  save_intermediate: true
  save_plots: true

# Reproducibility
reproducibility:
  save_metadata: true
  save_config_snapshot: true
  save_git_commit: true

# Logging
logging:
  level: "INFO"
  save_logs: true
